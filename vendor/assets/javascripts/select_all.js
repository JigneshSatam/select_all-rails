if("undefined"==typeof jQuery)throw new Error("select_all requires jQuery");!function(t){t.fn.select_all=function(e){function a(e){for(var a,c;!e.is("body");)c=e.find(":checkbox.selectable"),c.length>0?(a=c,e=t("body")):e=e.parent();return a}function c(e,a,c){switch(e.data("show_count")){case"checked":count_result="(Selected "+a+")";break;case"checked_with_total":count_result="("+a+"/"+c+")";break;case"unchecked":var l=c-a;count_result="(Unselected "+l+")";break;default:count_result="(Selected "+a+")"}var n=t(e.data("attach_count_to"));0==n.length&&(n=e.parent()),t("span#select_all_count_id[data-select_all_uid='"+e.data("select_all_uid")+"']").length>0?t("span#select_all_count_id[data-select_all_uid='"+e.data("select_all_uid")+"']").text(count_result):t("<span id='select_all_count_id' data-select_all_uid="+e.data("select_all_uid")+">"+count_result+"</span>").appendTo(n)}function l(e){t(e).change(function(){var e=t(".select_all[data-select_all_class='"+d["class"]+"']"),a=t(".selectable."+d["class"]+":checked").length,l=t(".selectable."+d["class"]).length;a==l?e.prop("checked","checked"):e.prop("checked",!1),e.data("show_count").length>0&&c(e,a,l)})}function n(e){e.change(function(){var a=t(".selectable."+d["class"]),l=t(this).prop("checked");if(a.prop("checked",l),e.data("show_count").length>0){var n=l?a.length:0;c(e,n,a.length)}})}var s,d=t.extend({"class":"no_class",infinite_scroll_select:!1,show_count:!1,attach_count_to:!1,uniq_id:Math.random()},e),o=t(this),_=o;return o.addClass("select_all").attr("data-select_all_class",d["class"]).attr("data-select_all_uid",d.uniq_id),o.data("show_count",d.show_count),o.data("attach_count_to",d.attach_count_to),s=a(_),s.length>0&&s.addClass(d["class"]),t(".select_all[data-select_all_class='"+d["class"]+"']").change(function(){t(".selectable."+d["class"]).prop("checked",t(this).prop("checked"))}),d.infinite_scroll_select&&(t(o).attr("data-total_child_count",s.length),t(document).ajaxComplete(function(e,n,s){t("[data-total_child_count]").each(function(){var e=t(this),n=a(e);n.length>e.data("total_child_count")&&(n.addClass(e.data("select_all_class")),e.attr("data-total_child_count",n.length),l(n),e.prop("checked")&&n.prop("checked",!0),e.data("show_count")&&c(e,n.parent().find(":checked").length,n.length))})})),d.show_count!==!1&&c(o,s.parent().find(":checked").length,s.length),n(o),l(s),t(this)}}(jQuery);
